
<body>
<style>
*{
  margin:0;
  padding:0;
  overflow: hidden;
}
  </style>
<canvas width="320" height="240" id="c" style="float:left"></canvas>
<script>
	var fps=5000, count=0, MAX=10000;
	var now = +new Date();
	var canvas = document.getElementById("c");
	var ctx = canvas.getContext("2d");
	ctx.fillStyle="red";
	ctx.lineStyle="black";
	window.addEventListener("message", function(){
	  ctx.clearRect(0, 0, 320, 240);
	  ctx.fillRect(128, 96, 64, 48);
	  ctx.strokeRect(128, 96, 64, 48);
	  ctx.textAlign="center";
	  ctx.fillText(fps, 160 + 16*Math.sin(count/(MAX/Math.PI/2)), 90);
	  if(count >= MAX){
	    var diff = new Date() - now;
		fps = Math.round(count/diff*1000);
		count = 0;
		now += diff;
	  }else{
		count++;
	  }
	  window.postMessage("hi", "*");
	}, false);
	window.postMessage("hi", "*");
</script>
</html>